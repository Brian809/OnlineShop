# 前端用户中心功能实现文档

## 已完成的功能

### 1. 用户中心页面 (`Profile.vue`)
- ✅ **基本信息管理**
  - 用户名编辑
  - 邮箱编辑
  - 姓名编辑（姓、名）
  - 手机号编辑
  - 地址编辑
  - 实时保存

- ✅ **修改密码**
  - 旧密码验证
  - 新密码输入
  - 新密码长度验证（至少6位）
  - 防止新旧密码相同

- ✅ **地址管理**
  - 地址列表展示（卡片式布局）
  - 添加新地址
  - 编辑现有地址
  - 删除地址（带确认对话框）
  - 设置默认地址
  - 地址字段：收货人、手机号、省份、城市、区县、详细地址、邮政编码、默认标记

### 2. 路由配置
- ✅ 添加 `/profile` 路由
- ✅ 配置路由守卫（需要登录）
- ✅ 导入 Profile 组件

### 3. 导航栏更新
- ✅ 桌面端添加"个人中心"链接
- ✅ 移动端添加"我的"链接
- ✅ 仅在登录状态下显示

### 4. 购物车升级
- ✅ 添加结算对话框
- ✅ 支持选择收货地址
- ✅ 从后端获取地址列表
- ✅ 创建订单时传入地址ID
- ✅ 无地址时提示用户添加地址

### 5. 订单展示升级
- ✅ 添加收货地址列
- ✅ 显示收货人姓名和电话
- ✅ 显示完整收货地址
- ✅ 无地址时显示提示

## 页面结构

### 用户中心页面 (`/profile`)
```
Profile.vue
├── el-tabs (选项卡)
│   ├── 基本信息
│   │   └── el-form (用户信息表单)
│   ├── 修改密码
│   │   └── el-form (密码修改表单)
│   └── 地址管理
│       ├── 地址列表
│       └── 添加/编辑对话框
```

### 购物车组件
```
cart.vue
├── 浮动按钮
├── 购物车抽屉
│   ├── 购物车列表
│   └── 底部结算区域
└── 结算对话框
    └── 地址选择列表
```

## API 调用

### 用户信息
- `GET /api/users/me` - 获取用户信息
- `PATCH /api/users/me` - 更新用户信息
- `PATCH /api/users/me/password` - 修改密码

### 地址管理
- `GET /api/users/me/addresses` - 获取地址列表
- `POST /api/users/me/addresses` - 添加地址
- `PUT /api/users/me/addresses/:addressId` - 更新地址
- `DELETE /api/users/me/addresses/:addressId` - 删除地址
- `PATCH /api/users/me/addresses/:addressId/default` - 设置默认地址

### 订单创建
- `POST /api/orders/create` - 创建订单（支持 addressId）

## 样式特点

### 响应式设计
- 用户中心页面适配不同屏幕尺寸
- 地址列表使用 Grid 布局
- 移动端优化

### 交互体验
- Tab 切换优化
- 表单验证提示
- 加载状态显示
- 删除确认对话框
- 成功/错误消息提示

### 视觉效果
- Element Plus 组件库
- 卡片式布局
- 地址卡片悬停效果
- 标签显示默认地址

## 数据流

### 用户信息更新流程
1. 用户修改表单 → 2. 点击保存 → 3. 调用 API → 4. 更新成功 → 5. 刷新数据

### 地址管理流程
1. 打开对话框 → 2. 填写表单 → 3. 保存 → 4. 调用 API → 5. 刷新地址列表

### 结算流程
1. 购物车点击结算 → 2. 打开地址选择对话框 → 3. 选择地址 → 4. 确认结算 → 5. 创建订单 → 6. 清空购物车 → 7. 跳转订单页面

## 表单验证

### 用户信息
- 用户名：不能重复
- 邮箱：不能重复，格式验证
- 手机号：可选

### 修改密码
- 旧密码：必填，必须正确
- 新密码：必填，至少6位，不能与旧密码相同

### 地址信息
- 收货人：必填
- 手机号：必填
- 省份：必填
- 城市：必填
- 区县：必填
- 详细地址：必填
- 邮政编码：可选

## 服务状态

- ✅ 前端服务已启动（http://localhost:5173）
- ✅ 后端服务已启动（http://localhost:3000）
- ✅ 所有功能可正常使用

## 使用方式

1. 访问前端：http://localhost:5173
2. 登录后点击导航栏的"个人中心"
3. 可以：
   - 编辑基本信息
   - 修改密码
   - 管理收货地址
4. 在购物车结算时选择收货地址
5. 在订单列表查看收货地址信息

## 注意事项

1. 所有操作都需要用户登录
2. 地址删除后会提示确认
3. 设置默认地址会自动取消其他默认地址
4. 结算时如果没有地址会提示用户添加
5. 订单创建后即使删除地址，订单仍保留收货人信息